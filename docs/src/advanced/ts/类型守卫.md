# ç±»å‹å®ˆå«

## ä»€ä¹ˆæ˜¯ç±»å‹å®ˆå« ğŸ›¡ï¸

ç±»å‹å®ˆå«æ˜¯ TypeScript ä¸­çš„ä¸€ä¸ªç‰¹æ€§ï¼Œå®ƒå…è®¸ä½ åœ¨ä½¿ç”¨ç‰¹å®šçš„å˜é‡æˆ–å±æ€§ä¹‹å‰ï¼Œå¯¹å˜é‡çš„ç±»å‹è¿›è¡Œæ›´ç²¾ç¡®çš„æ£€æŸ¥ã€‚è¿™åœ¨å¤„ç†è”åˆç±»å‹æˆ–ä»»ä½•ç±»å‹æ—¶ç‰¹åˆ«æœ‰ç”¨ï¼Œå¯ä»¥ç¼©å°å˜é‡çš„å¯èƒ½ç±»å‹èŒƒå›´ï¼Œä»è€Œæä¾›æ›´å…·ä½“çš„ç±»å‹ä¿¡æ¯ç»™ç¼–è¯‘å™¨ã€‚

ä¾‹å¦‚ ğŸŒ°ï¼š

```ts
function printValue(value: string | number) {
  if (typeof value === "string") {
    console.log(value.toUpperCase()); // å­—ç¬¦ä¸²å¤„ç†
  } else {
    console.log(value.toFixed(2)); // æ•°å­—å¤„ç†
  }
}
```

åœ¨ `if (typeof value === "string")` åˆ†æ”¯ä¸‹ï¼ŒTypeScript ä¼šçŸ¥é“ `value` çš„ç±»å‹æ˜¯ `string`ï¼Œå› æ­¤å¯ä»¥å®‰å…¨åœ°è°ƒç”¨ `toUpperCase` æ–¹æ³•ã€‚åœ¨ `else` åˆ†æ”¯ä¸‹ï¼ŒTypeScript ä¼šçŸ¥é“ `value` çš„ç±»å‹æ˜¯ `number`ï¼Œå› æ­¤å¯ä»¥å®‰å…¨åœ°è°ƒç”¨ `toFixed` æ–¹æ³•ã€‚

## ç±»å‹å®ˆå«çš„ç§ç±»

### typeof ç±»å‹å®ˆå«

`typeof` ç±»å‹å®ˆå«ç”¨äºæ£€æŸ¥å˜é‡çš„ç±»å‹æ˜¯å¦ä¸ºç‰¹å®šçš„åŸå§‹ç±»å‹ï¼Œå¦‚ `string`ã€`number`ã€`boolean` ç­‰ã€‚å®ƒè¿”å›ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œè¡¨ç¤ºå˜é‡çš„ç±»å‹ã€‚

```ts
function printValue(value: string | number) {
  if (typeof value === "string") {
    console.log(value.toUpperCase()); // å­—ç¬¦ä¸²å¤„ç†
  } else {
    console.log(value.toFixed(2)); // æ•°å­—å¤„ç†
  }
}
```

### instanceof ç±»å‹å®ˆå«

`instanceof` ç±»å‹å®ˆå«ç”¨äºæ£€æŸ¥ä¸€ä¸ªå¯¹è±¡æ˜¯å¦æ˜¯æŸä¸ªæ„é€ å‡½æ•°çš„å®ä¾‹ã€‚å®ƒè¿”å›ä¸€ä¸ªå¸ƒå°”å€¼ï¼Œè¡¨ç¤ºå¯¹è±¡æ˜¯å¦æ˜¯æŸä¸ªç±»çš„å®ä¾‹ã€‚

```ts
class Person {
  name: string;
  age: number;
}

class Animal {
  species: string;
}

function printValue(value: Person | Animal) {
  if (value instanceof Person) {
    console.log(value.name); // Person å±æ€§å¤„ç†
  } else {
    console.log(value.species); // Animal å±æ€§å¤„ç†
  }
}
```

### in ç±»å‹å®ˆå«

`in` ç±»å‹å®ˆå«ç”¨äºæ£€æŸ¥ä¸€ä¸ªå¯¹è±¡æ˜¯å¦å…·æœ‰æŸä¸ªå±æ€§ã€‚å®ƒè¿”å›ä¸€ä¸ªå¸ƒå°”å€¼ï¼Œè¡¨ç¤ºå¯¹è±¡æ˜¯å¦å…·æœ‰è¯¥å±æ€§ã€‚

```ts
interface Person {
  name: string;
  age: number;
}

interface Animal {
  species: string;
}

function printValue(value: Person | Animal) {
  if ("name" in value) {
    console.log(value.name); // Person å±æ€§å¤„ç†
  } else {
    console.log(value.species); // Animal å±æ€§å¤„ç†
  }
}
```

### è‡ªå®šä¹‰ç±»å‹å®ˆå«

åœ¨æ—¥å¸¸å¼€å‘ä¸­ï¼Œç”±äºåˆ¤æ–­æ¡ä»¶è¿‡å¤šï¼Œæˆ‘ä»¬éœ€è¦å°†åˆ¤æ–­çš„æ¡ä»¶æå–å‡ºæ¥ï¼Œå°è£…æˆä¸€ä¸ªå‡½æ•°ï¼Œä¾‹å¦‚ ğŸŒ°ï¼š

```ts
interface Person {
  name: string;
  age: number;
}

interface Animal {
  species: string;
}

function isPerson(value: any): boolean {
  return (
    value !== null &&
    typeof value === "object" &&
    "name" in value &&
    "age" in value
  );
}

function printValue(value: Person | Animal) {
  if (isPerson(value)) {
    // ç±»å‹â€œPerson | Animalâ€ä¸Šä¸å­˜åœ¨å±æ€§â€œnameâ€ã€‚ç±»å‹â€œAnimalâ€ä¸Šä¸å­˜åœ¨å±æ€§â€œnameâ€ã€‚
    console.log(value.name); // [!code error]
  } else {
    console.log(value.species); // Animal å±æ€§å¤„ç†
  }
}
```

ä¸Šé¢çš„ä»£ç çœ‹èµ·æ¥å¾ˆç®€å•ï¼Œæ‰§è¡Œç±»å‹åˆ¤æ–­çš„æ—¶å€™å¦‚æœ isPerson è¿”å›äº† trueï¼Œé‚£ value è‚¯å®šä¹Ÿæ˜¯ isPerson ç±»å‹ï¼Œä½†æ˜¯ä¸ºä»€ä¹ˆæŠ¥é”™äº†å‘¢ï¼Ÿ

å› ä¸º isPerson è¿™ä¸ªå‡½æ•°åœ¨å¦å¤–ä¸€ä¸ªåœ°æ–¹ï¼Œå†…éƒ¨çš„åˆ¤æ–­é€»è¾‘å¹¶ä¸åœ¨å‡½æ•° printValue ä¸­ã€‚è¿™é‡Œçš„ç±»å‹æ§åˆ¶æµåˆ†æåšä¸åˆ°è·¨å‡½æ•°ä¸Šä¸‹æ–‡æ¥è¿›è¡Œç±»å‹çš„ä¿¡æ¯æ”¶é›†ï¼ˆä½†åˆ«çš„ç±»å‹è¯­è¨€ä¸­å¯èƒ½æ˜¯æ”¯æŒçš„ï¼‰ã€‚

å®é™…ä¸Šï¼Œå°†åˆ¤æ–­é€»è¾‘å°è£…èµ·æ¥æå–åˆ°å‡½æ•°å¤–éƒ¨è¿›è¡Œå¤ç”¨éå¸¸å¸¸è§ã€‚ä¸ºäº†è§£å†³è¿™ä¸€ç±»å‹æ§åˆ¶æµåˆ†æçš„èƒ½åŠ›ä¸è¶³ï¼Œ TypeScript å¼•å…¥äº† **is å…³é”®å­—**æ¥æ˜¾å¼åœ°æä¾›ç±»å‹ä¿¡æ¯ï¼š

```ts
function isPerson(value: any): value is Person {
  return (
    value !== null &&
    typeof value === "object" &&
    "name" in value &&
    "age" in value
  );
}

function printValue(value: Person | Animal) {
  if (isPerson(value)) {
    console.log(value.name); // Person å±æ€§å¤„ç†
  } else {
    console.log(value.species); // Animal å±æ€§å¤„ç†
  }
}
```

åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œ`isPerson` å‡½æ•°æ˜¯ä¸€ä¸ªè‡ªå®šä¹‰çš„ç±»å‹å®ˆå«å‡½æ•°ï¼Œç”¨äºæ£€æŸ¥ä¸€ä¸ªå¯¹è±¡æ˜¯å¦æ˜¯ `Person` ç±»å‹ã€‚å®ƒè¿”å›ä¸€ä¸ªå¸ƒå°”å€¼ï¼Œè¡¨ç¤ºå¯¹è±¡æ˜¯å¦å…·æœ‰ `name` å’Œ `age` å±æ€§ã€‚åœ¨ `printValue` å‡½æ•°ä¸­ï¼Œæˆ‘ä»¬ä½¿ç”¨ `isPerson` å‡½æ•°æ¥ç¼©å°å˜é‡çš„ç±»å‹èŒƒå›´ï¼Œä»è€Œæä¾›æ›´å…·ä½“çš„ç±»å‹ä¿¡æ¯ç»™ç¼–è¯‘å™¨ã€‚
